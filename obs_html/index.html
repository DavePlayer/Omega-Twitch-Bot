<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title>clock</title>
        <script
            src="https://cdn.socket.io/3.1.3/socket.io.min.js"
            integrity="sha384-cPwlPLvBTa3sKAgddT6krw0cJat7egBga3DJepJyrLl4Q9/5WLra3rrnMcyTyOnh"
            crossorigin="anonymous"
        ></script>
    </head>
    <body>
        <p class="time"></p>
    </body>

    <script charset="utf-8">
        class timer {
            constructor() {
                this.hours = 0
                this.minutes = 0
                this.seconds = 10
                this.wsConnection = null
            }

            updateClock() {
                console.log("tik tak", `${this.hours}:${this.minutes}:${this.seconds}`)
                document.querySelector(".time").innerText = `${this.hours}:${this.minutes}:${this.seconds}`
            }

            countDown() {
                setTimeout(() => {
                    console.log("second have passed")
                    if (this.seconds > 0) {
                        this.seconds -= 1
                    } else {
                        this.seconds = 59
                        if (this.minutes > 0) {
                            this.minutes -= 1
                        } else {
                            this.minutes = 59
                            if (this.hours > 0) {
                                this.hours -= 1
                            } else {
                                this.hours = 0
                                return 1
                            }
                        }
                    }
                    this.updateClock()
                    this.countDown()
                }, 1000)
            }
        }
        const clock = new timer()
        console.log("sth works")
        clock.updateClock()
        clock.countDown()
        if (window.WebSocket) {
            const socket = io("ws://127.0.0.1:8080")
            socket.on("message", (text) => {
                console.log(text)
            })
        }
    </script>
</html>
